#!/bin/bash

set -eu # -x for verbose logging to ensemble debug-log

DEBIAN_FRONTEND=noninteractive apt-get -y install -qq --no-install-recommends gmetad ganglia-monitor ganglia-webfrontend

#gmetad_aleady_configured() {
#}
#configure_gmetad() {
#}
#gmetad_already_configured || configure_gmetad

#gmond_aleady_configured() {
#}
#configure_gmond() {
#}
#gmond_already_configured || configure_gmond

apache_already_configured() {
  [ -L /etc/apache2/conf.d/ganglia.conf ]
}
configure_apache() {
  ensemble-log "Configure apache vhost for ganglia"
  if [ -f /etc/ganglia-webfrontend/apache.conf ]; then
    ln -sf /etc/ganglia-webfrontend/apache.conf /etc/apache2/conf.d/ganglia.conf
  fi
}
apache_already_configured || configure_apache

